<?xml version="1.0" encoding="utf-8"?>
<!--
  Copyright 2018 Barroux Abbey (https://www.barroux.org/)
  @author: Alexis de Lattre <alexis.delattre@akretion.com>
  License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
-->

<odoo>


<record id="view_warehouse" model="ir.ui.view">
    <field name="name">fruit.mill.stock.warehouse.form</field>
    <field name="model">stock.warehouse</field>
    <field name="inherit_id" ref="stock.view_warehouse"/>
    <field name="arch" type="xml">
        <xpath expr="//group[@name='group_resupply']" position="inside">
            <field name="fruit_mill" />
        </xpath>
        <xpath expr="//field[@name='reception_steps']/../.." position="before">
            <page name="fruit_mill" string="Fruit Mill" attrs="{'invisible': [('fruit_mill', '=', False)]}">
                <group name="fruit_mill">
                <group name="fruit_lended_cases" string="Lended Cases">
                    <field name="fruit_regular_case_total"/>
                    <field name="fruit_regular_case_stock"/>
                    <field name="fruit_organic_case_total"/>
                    <field name="fruit_organic_case_stock"/>
                </group>

                <group name="fruit_mill_right" string="Compensation">
                    <label for="fruit_compensation_last_qty"/>
                    <div name="fruit_compensation_last_qty">
                        <field name="fruit_compensation_last_qty" class="oe_inline"/>
                        <label for="fruit_compensation_last_qty" string=" kg"/>
                    </div>
                    <label for="fruit_juice_compensation_ratio"/>
                    <div name="fruit_juice_compensation_ratio">
                        <field name="fruit_juice_compensation_ratio" class="oe_inline"/>
                        <label for="fruit_juice_compensation_ratio" string=" %"/>
                    </div>
                    <field name="fruit_juice_compensation_ratio_update_date"/>
                    <label for="fruit_juice_compensation_ratio_days"/>
                    <div name="fruit_juice_compensation_ratio_days">
                        <field name="fruit_juice_compensation_ratio_days" class="oe_inline"/>
                        <label for="fruit_juice_compensation_ratio_days" string=" last days"/>
                    </div>
                    <button name="fruit_juice_compensation_ratio_update" type="object" string="Update Compensation Ratio" colspan="2"/>
                </group>
                <group name="fruit_mill_left" string="Locations">
                    <field name="fruit_withdrawal_loc_id" attrs="{'required': [('fruit_mill', '=', True)]}"/>
                    <field name="fruit_compensation_loc_id"/>
                </group>

                </group>
            </page>
        </xpath>
    </field>
</record>

<record id="stock_warehouse_view_search" model="ir.ui.view">
    <field name="name">fruit.mill.stock.warehouse.search</field>
    <field name="model">stock.warehouse</field>
    <field name="inherit_id" ref="stock.stock_warehouse_view_search"/>
    <field name="arch" type="xml">
        <filter name="inactive" position="before">
            <filter string="Fruit Mill" name="fruit_mill" domain="[('fruit_mill', '=', True)]"/>
            <separator/>
        </filter>
    </field>
</record>

<record id="stock_warehouse_fruit_mill_action" model="ir.actions.act_window">
    <field name="name">Warehouse</field>
    <field name="res_model">stock.warehouse</field>
    <field name="view_mode">tree,form</field>
    <field name="context">{'default_fruit_mill': True, 'search_default_fruit_mill': True}</field>
</record>

<menuitem id="stock_warehouse_fruit_mill_menu" action="stock_warehouse_fruit_mill_action" parent="fruit_data_menu" sequence="100"/>

</odoo>
